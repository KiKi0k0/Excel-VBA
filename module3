Option Explicit


Const posY As Single = 1
Const posX As Single = 1

Const posY_change As Single = 2
Const posX_change As Single = 1


Const Focus_Offset_Row As Single = 10
Const Focus_Offset_Column As Single = 10


Sub test()



    Dim Search_Word As String
    Dim Search_Range As Range
    
    Dim Change_Word As String
    Dim Message_Result As VbMsgBoxResult
    
    Dim memo As String
    
    Search_Word = ThisWorkbook.ActiveSheet.Cells(posY, posX).Value
    Change_Word = ThisWorkbook.ActiveSheet.Cells(posY_change, posX_change).Value
    
    Set Search_Range = ThisWorkbook.ActiveSheet.Cells.Find(Search_Word)
    
    If Search_Range.Row = posY And Search_Range.Column = posX Then
        MsgBox ("検索した文字列は存在しませんでした。")
        Exit Sub
    End If
    
    
    Debug.Print Search_Range.Address & "には" & Search_Range.Value & "と入力されています。"
        
        
    memo = ThisWorkbook.ActiveSheet.Cells(Search_Range.Row, Search_Range.Column).Value
    Debug.Print memo
    
    
    ThisWorkbook.ActiveSheet.Cells(Search_Range.Row, Search_Range.Column).Select
    ActiveWindow.ScrollRow = Search_Range.Row - Focus_Offset_Row
    ActiveWindow.ScrollColumn = Search_Range.Column - Focus_Offset_Column
    
    
    Message_Result = MsgBox(Search_Word & "の文字列を" & Change_Word & "に変換します。" & vbLf & "問題がないことを確認してください。", vbYesNoCancel, "文字列置換え")
    
    If Message_Result = vbYes Then
    
        ThisWorkbook.ActiveSheet.Cells(Search_Range.Row, Search_Range.Column).Value = Change_Word
    
    Else
        
        MsgBox ("キャンセルしました。")
        
    End If



End Sub


Sub Sample1()
    With Application.FileDialog(msoFileDialogFolderPicker)
        If .Show = True Then
            ThisWorkbook.ActiveSheet.Cells(1, 1).Value = .SelectedItems(1)
        End If
    End With
End Sub


Sub Test()

    Dim FileName As Variant
    
    If ThisWorkbook.ActiveSheet.Cells(1, 1).Value = "" Then
        'フォルダ位置移動
        ChDir "D:\"
    Else
        '既に記載があれば、以前使用したエクセルが存在するフォルダの階層を抽出
        Debug.Print Left(ThisWorkbook.ActiveSheet.Cells(1, 1).Value, InStrRev(ThisWorkbook.ActiveSheet.Cells(1, 1).Value, "\"))
    End If

    FileName = Application.GetOpenFilename(FileFilter:="Excelブック,*.xlsx,CSVファイル,*.csv")
    
    If FileName = False Then
        Exit Sub
    End If
    
    ThisWorkbook.ActiveSheet.Cells(1, 1).Value = FileName
  
End Sub

Public Sub AddExcel_Information()

    Dim i As Single
    Dim wbk As Workbook
    Dim Workbook_Name As String

    '既に記載があれば、以前使用したエクセルが存在するフォルダの階層を抽出
    'Debug.Print Right(ThisWorkbook.ActiveSheet.Cells(posY, posX).Value, Len(ThisWorkbook.ActiveSheet.Cells(posY, posX).Value) - InStrRev(ThisWorkbook.ActiveSheet.Cells(posY, posX).Value, "\"))

    Workbook_Name = Right(ThisWorkbook.ActiveSheet.Cells(posY, posX).Value, Len(ThisWorkbook.ActiveSheet.Cells(posY, posX).Value) - InStrRev(ThisWorkbook.ActiveSheet.Cells(posY, posX).Value, "\"))

    Workbooks.Open ThisWorkbook.ActiveSheet.Cells(posY, posX).Value
    Set wbk = Workbooks(Workbook_Name)
    
    For i = 1 To wbk.Worksheets.Count
        MainMenu.Exchange_Sheet_Select.AddItem wbk.Worksheets(i).Name
        MainMenu.Search_Sheet_Select.AddItem wbk.Worksheets(i).Name
    Next

End Sub

